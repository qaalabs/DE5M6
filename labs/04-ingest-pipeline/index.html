<!DOCTYPE html><html lang="en" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../day1/cloud-monitoring-report-back/">
      
      
        <link rel="next" href="../../day2/breaking-things/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Lab 2.1 ~ 04 Ingest Pipeline - Module 6 - Data Operations</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e53b48f4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lab-ingest-data-with-a-pipeline-in-microsoft-fabric" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Module 6 - Data Operations" class="md-header__button md-logo" aria-label="Module 6 - Data Operations" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3C7.58 3 4 4.79 4 7s3.58 4 8 4 8-1.79 8-4-3.58-4-8-4M4 9v3c0 2.21 3.58 4 8 4s8-1.79 8-4V9c0 2.21-3.58 4-8 4s-8-1.79-8-4m0 5v3c0 2.21 3.58 4 8 4s8-1.79 8-4v-3c0 2.21-3.58 4-8 4s-8-1.79-8-4"></path></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Module 6 - Data Operations
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab 2.1 ~ 04 Ingest Pipeline
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Module 6 - Data Operations" class="md-nav__button md-logo" aria-label="Module 6 - Data Operations" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3C7.58 3 4 4.79 4 7s3.58 4 8 4 8-1.79 8-4-3.58-4-8-4M4 9v3c0 2.21 3.58 4 8 4s8-1.79 8-4V9c0 2.21-3.58 4-8 4s-8-1.79-8-4m0 5v3c0 2.21 3.58 4 8 4s8-1.79 8-4v-3c0 2.21-3.58 4-8 4s-8-1.79-8-4"></path></svg>

    </a>
    Module 6 - Data Operations
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2">
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Agenda
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Agenda
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agenda/day1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Day 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agenda/day2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Day 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agenda/day3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Day 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agenda/day4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Day 4
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3">
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Day 1 - Monitoring &amp; Performance
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Day 1 - Monitoring &amp; Performance
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day1/status-page-report-back/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Status page ~ Report back
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-lakehouse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 1.1 ~ 01 Create Fabric Lakehouse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-dataflows-gen2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 1.2 ~ 05 Dataflows Gen2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../18-monitor-hub/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 1.3 ~ 18 Monitor Hub
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06c-monitor-data-warehouse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 1.4 ~ 06c Monitor Warehouse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day1/cloud-monitoring-report-back/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud monitoring ~ Report back
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Day 2 - Incident Response
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Day 2 - Incident Response
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Lab 2.1 ~ 04 Ingest Pipeline
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Lab 2.1 ~ 04 Ingest Pipeline
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#create-a-workspace" class="md-nav__link">
    <span class="md-ellipsis">
      Create a workspace
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-lakehouse" class="md-nav__link">
    <span class="md-ellipsis">
      Create a lakehouse
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Create a pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-notebook" class="md-nav__link">
    <span class="md-ellipsis">
      Create a notebook
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modify-the-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Modify the pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dont-delete-the-workspace" class="md-nav__link">
    <span class="md-ellipsis">
      Don't delete the workspace
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day2/breaking-things/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 04 ~ Break it systematically
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day2/complex-breaking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 04 ~ More complex breaks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11-data-activator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab ~ 11 Data Activator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day2/incident-response-prep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fire Drill preparation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day2/fire-drill-groups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🔥 Fire Drill Round 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day2/fire-drill-groups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🔥 Fire Drill Round 1
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5">
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Day 3 - Quality &amp; Governance
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Day 3 - Quality &amp; Governance
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03b-medallion-lakehouse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 3.1 ~ 03b Medallion Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day3/quality-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quality tools ~ report back
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../19-secure-data-access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 3.2 ~ 19 Secure Data Access
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21-deployment-pipelines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 3.3 ~ 21 Deployment Pipelines
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6">
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Day 4 - Improvement &amp; Value
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Day 4 - Improvement &amp; Value
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day4/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instructions &amp; Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day4/sprint1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Planning for Sprint 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day4/sprint2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Planning for Sprint 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day4/sprint3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Planning for Sprint 3
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="lab-ingest-data-with-a-pipeline-in-microsoft-fabric">Lab: Ingest Data with a Pipeline in Microsoft Fabric</h1>
<p>A data lakehouse is a common analytical data store for cloud-scale analytics solutions. One of the core tasks of a data engineer is to implement and manage the ingestion of data from multiple operational data sources into the lakehouse. In Microsoft Fabric, you can implement <em>extract, transform, and load</em> (ETL) or <em>extract, load, and transform</em> (ELT) solutions for data ingestion through the creation of <em>pipelines</em>.</p>
<p>Fabric also supports Apache Spark, enabling you to write and run code to process data at scale. By combining the pipeline and Spark capabilities in Fabric, you can implement complex data ingestion logic that copies data from external sources into the OneLake storage on which the lakehouse is based, and then uses Spark code to perform custom data transformations before loading it into tables for analysis.</p>
<p>This lab will take approximately <strong>45</strong> minutes to complete.</p>
<div class="admonition info">
<p class="admonition-title">For this lab you need to navigate to QA Platform and login using the credentials provided</p>
</div>
<div class="admonition warning">
<p class="admonition-title">It is important that you use an incognito/private mode browser tab and not your work or personal Microsoft login</p>
</div>
<p>In this lab, you will sign in to Microsoft Fabric using the email and password from the QA Platform.</p>
<ol>
<li>
<p>Using an <strong>incognito/private mode browser tab</strong> navigate to the <a href="https://app.fabric.microsoft.com/">Fabric portal</a> at: <a href="https://fabric.microsoft.com">https://fabric.microsoft.com</a></p>
</li>
<li>
<p>Follow the prompts, and sign in with the user credentials from the QA Platform:</p>
<ul>
<li>Email</li>
<li>Password</li>
</ul>
</li>
</ol>
<p>After signing in, you will be redirected to the Fabric home page:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/qa-fabric-home.png" data-desc-position="bottom"><img alt="Fabric home page" src="../../img/qa-fabric-home.png"></a></p>
<h2 id="create-a-workspace">Create a workspace</h2>
<p>Before working with data in Fabric, you need to create a workspace with the Fabric trial enabled.</p>
<ol>
<li>
<p>Navigate to the <a href="https://app.fabric.microsoft.com/home?experience=fabric">Microsoft Fabric home page</a> in an incognito/private mode browser tab browser, and sign in with the Fabric credentials from the QA Platform.</p>
</li>
<li>
<p>In the menu bar on the left, select Workspaces (the icon looks similar to 🗇).</p>
</li>
<li>
<p>Create a <strong>New workspace</strong>:</p>
<ul>
<li>Give it a name of your choice. For example: <code>fab_workspace</code></li>
<li>Leave all other options as the default values</li>
<li>Click <strong>Apply</strong></li>
</ul>
</li>
<li>
<p>When your new workspace opens, it should be empty.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/new-workspace.png" data-desc-position="bottom"><img alt="Screenshot of an empty workspace in Fabric." src="../../img/new-workspace.png"></a></p>
</li>
</ol>
<h2 id="create-a-lakehouse">Create a lakehouse</h2>
<p>Now that you have a workspace, it's time to create a data lakehouse into which you'll ingest data.</p>
<ol>
<li>
<p>On the menu bar on the left, select <strong>Create</strong>. In the New page, under the <em>Data Engineering</em> section, select <strong>Lakehouse</strong>.</p>
<ul>
<li>Give it a uniquename of your choice. For example: <code>fab_lakehouse</code></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">If the <strong>Create</strong> option is not pinned to the sidebar, you need to select the ellipsis (…) option first.</p>
</div>
<p>After a minute or so, a new lakehouse with no <strong>Tables</strong> or <strong>Files</strong> will be created.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/new-lakehouse.png" data-desc-position="bottom"><img alt="New lakehouse." src="../../img/new-lakehouse.png"></a></p>
</li>
<li>
<p>On the <strong>Explorer</strong> pane on the left, in the <strong>...</strong> menu for the <strong>Files</strong> node, select <strong>New subfolder</strong> and create a subfolder named <strong>new_data</strong></p>
</li>
</ol>
<h2 id="create-a-pipeline">Create a pipeline</h2>
<p>A simple way to ingest data is to use a <strong>Copy Data</strong> activity in a pipeline to extract the data from a source and copy it to a file in the lakehouse.</p>
<ol>
<li>
<p>On the <strong>Home</strong> page for your lakehouse, select <strong>Get data</strong> and then select <strong>New data pipeline</strong>, and create a new data pipeline named <code>Ingest Sales Data</code></p>
</li>
<li>
<p>If the <strong>Copy Data</strong> wizard doesn't open automatically, select <strong>Copy Data &gt; Use copy assistant</strong> in the pipeline editor page.</p>
</li>
<li>
<p>In the <strong>Copy Data</strong> wizard, on the <strong>Choose data source page</strong>, type HTTP in the search bar and then select <strong>HTTP</strong> in the <strong>New sources</strong> section.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/04-choose-data-source.png" data-desc-position="bottom"><img alt="Screenshot of the Choose data source page." src="../../img/04-choose-data-source.png"></a></p>
</li>
<li>
<p>In the <strong>Connect to data source</strong> pane, enter the following settings for the connection to your data source:</p>
<ul>
<li><strong>URL</strong>: <a href="https://raw.githubusercontent.com/MicrosoftLearning/dp-data/main/sales.csv">https://raw.githubusercontent.com/MicrosoftLearning/dp-data/main/sales.csv</a></li>
<li><strong>Connection</strong>: Create new connection</li>
<li><strong>Connection name</strong>: <em>Specify a unique name</em></li>
<li><strong>Data gateway</strong>: (none)</li>
<li><strong>Authentication kind</strong>: Anonymous</li>
</ul>
</li>
<li>
<p>Select <strong>Next</strong>. Then ensure the following settings are selected:</p>
<ul>
<li><strong>Relative URL</strong>: <em>Leave blank</em></li>
<li><strong>Request method</strong>: GET</li>
<li><strong>Additional headers</strong>: <em>Leave blank</em></li>
<li><strong>Binary copy</strong>: <u>Un</u>selected</li>
<li><strong>Request timeout</strong>: <em>Leave blank</em></li>
<li><strong>Max concurrent connections</strong>: <em>Leave blank</em></li>
</ul>
</li>
<li>
<p>Select <strong>Next</strong>, and wait for the data to be sampled and then ensure that the following settings are selected:</p>
<ul>
<li><strong>File format</strong>: DelimitedText</li>
<li><strong>Column delimiter</strong>: Comma (,)</li>
<li><strong>Row delimiter</strong>: Line feed (\n)</li>
<li><strong>First row as header</strong>: Selected</li>
<li><strong>Compression type</strong>: None</li>
</ul>
</li>
<li>
<p>Select <strong>Preview data</strong> to see a sample of the data that will be ingested. Then close the data preview and select <strong>Next</strong>.</p>
</li>
<li>
<p>On the <strong>Connect to data destination</strong> page, set the following data destination options, and then select <strong>Next</strong>:</p>
<ul>
<li><strong>Root folder</strong>: Files</li>
<li><strong>Folder path name</strong>: new_data</li>
<li><strong>File name</strong>: sales.csv</li>
<li><strong>Copy behavior</strong>: None</li>
</ul>
</li>
<li>
<p>Set the following file format options and then select <strong>Next</strong>:</p>
<ul>
<li><strong>File format</strong>: DelimitedText</li>
<li><strong>Column delimiter</strong>: Comma (,)</li>
<li><strong>Row delimiter</strong>: Line feed (\n)</li>
<li><strong>Add header to file</strong>: Selected</li>
<li><strong>Compression type</strong>: None</li>
</ul>
</li>
<li>
<p>On the <strong>Copy summary</strong> page, review the details of your copy operation and then select <strong>Save + Run</strong>.</p>
<p>A new pipeline containing a <strong>Copy Data</strong> activity is created, as shown here:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/04-copy-data-pipeline.png" data-desc-position="bottom"><img alt="Screenshot of a pipeline with a Copy Data activity." src="../../img/04-copy-data-pipeline.png"></a></p>
</li>
<li>
<p>When the pipeline starts to run, you can monitor its status in the <strong>Output</strong> pane under the pipeline designer. Use the <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.65 6.35A7.96 7.96 0 0 0 12 4a8 8 0 0 0-8 8 8 8 0 0 0 8 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0 1 12 18a6 6 0 0 1-6-6 6 6 0 0 1 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"></path></svg></span> (<em>Refresh</em>) icon to refresh the status, and wait until it has succeeeded.</p>
</li>
<li>
<p>In the menu bar on the left, select your lakehouse.</p>
</li>
<li>
<p>On the <strong>Home</strong> page, in the <strong>Explorer</strong> pane, expand <strong>Files</strong> and select the <strong>new_data</strong> folder to verify that the <strong>sales.csv</strong> file has been copied.</p>
</li>
</ol>
<h2 id="create-a-notebook">Create a notebook</h2>
<ol>
<li>
<p>On the <strong>Home</strong> page for your lakehouse, in the <strong>Open notebook</strong> menu, select <strong>New notebook</strong>.</p>
<p>After a few seconds, a new notebook containing a single <em>cell</em> will open. Notebooks are made up of one or more cells that can contain <em>code</em> or <em>markdown</em> (formatted text).</p>
</li>
<li>
<p>Select the existing cell in the notebook, which contains some simple code, and then replace the default code with the following variable declaration.</p>
<div class="highlight"><pre><span></span><code><span class="n">table_name</span> <span class="o">=</span> <span class="s2">"sales"</span>
</code></pre></div>
</li>
<li>
<p>In the <strong>...</strong> menu for the cell (at its top-right) select <strong>Toggle parameter cell</strong>. This configures the cell so that the variables declared in it are treated as parameters when running the notebook from a pipeline.</p>
</li>
<li>
<p>Under the parameters cell, use the <strong>+ Code</strong> button to add a new code cell. Then add the following code to it:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql.functions</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Read the new sales data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"csv"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"header"</span><span class="p">,</span><span class="s2">"true"</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">"Files/new_data/*.csv"</span><span class="p">)</span>

<span class="c1">## Add month and year columns</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="n">year</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">"OrderDate"</span><span class="p">)))</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">"Month"</span><span class="p">,</span> <span class="n">month</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">"OrderDate"</span><span class="p">)))</span>

<span class="c1"># Derive FirstName and LastName columns</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">"FirstName"</span><span class="p">,</span> <span class="n">split</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">"CustomerName"</span><span class="p">),</span> <span class="s2">" "</span><span class="p">)</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">"LastName"</span><span class="p">,</span> <span class="n">split</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">"CustomerName"</span><span class="p">),</span> <span class="s2">" "</span><span class="p">)</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># Filter and reorder columns</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">"SalesOrderNumber"</span><span class="p">,</span> <span class="s2">"SalesOrderLineNumber"</span><span class="p">,</span> <span class="s2">"OrderDate"</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"Month"</span><span class="p">,</span> <span class="s2">"FirstName"</span><span class="p">,</span> <span class="s2">"LastName"</span><span class="p">,</span> <span class="s2">"EmailAddress"</span><span class="p">,</span> <span class="s2">"Item"</span><span class="p">,</span> <span class="s2">"Quantity"</span><span class="p">,</span> <span class="s2">"UnitPrice"</span><span class="p">,</span> <span class="s2">"TaxAmount"</span><span class="p">]</span>

<span class="c1"># Load the data into a table</span>
<span class="n">df</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"delta"</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="s2">"append"</span><span class="p">)</span><span class="o">.</span><span class="n">saveAsTable</span><span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
</code></pre></div>
<p>This code loads the data from the sales.csv file that was ingested by the <strong>Copy Data</strong> activity, applies some transformation logic, and saves the transformed data as a table - appending the data if the table already exists.</p>
</li>
<li>
<p>Verify that your notebooks looks similar to this, and then use the <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 5.14v14l11-7z"></path></svg></span> <strong>Run all</strong> button on the toolbar to run all of the cells it contains.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/04-notebook.png" data-desc-position="bottom"><img alt="Screenshot of a notebook with a parameters cell and code to transform data." src="../../img/04-notebook.png"></a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>Since this is the first time you've run any Spark code in this session, the Spark pool must be started.</li>
<li>This means that the first cell can take a minute or so to complete.</li>
</ul>
</div>
</li>
<li>
<p>When the notebook run has completed, in the <strong>Explorer</strong> pane on the left, in the <strong>...</strong> menu for <strong>Tables</strong> select <strong>Refresh</strong> and verify that a <strong>sales</strong> table has been created.</p>
</li>
<li>
<p>In the notebook menu bar, use the ⚙️ <strong>Settings</strong> icon to view the notebook settings. Then set the <strong>Name</strong> of the notebook to <code>Load Sales</code> and close the settings pane.</p>
</li>
<li>
<p>In the hub menu bar on the left, select your lakehouse.</p>
</li>
<li>
<p>In the <strong>Explorer</strong> pane, refresh the view. Then expand <strong>Tables</strong>, and select the <strong>sales</strong> table to see a preview of the data it contains.</p>
</li>
</ol>
<h2 id="modify-the-pipeline">Modify the pipeline</h2>
<p>Now that you've implemented a notebook to transform data and load it into a table, you can incorporate the notebook into a pipeline to create a reusable ETL process.</p>
<ol>
<li>
<p>In the hub menu bar on the left select the <strong>Ingest Sales Data</strong> pipeline you created previously.</p>
</li>
<li>
<p>On the <strong>Activities</strong> tab, in the <strong>All activities</strong> list, select <strong>Delete data</strong>. Then position the new <strong>Delete data</strong> activity to the left of the <strong>Copy data</strong> activity and connect its <strong>On completion</strong> output to the <strong>Copy data</strong> activity, as shown here:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/04-delete-data-activity.png" data-desc-position="bottom"><img alt="Screenshot of a pipeline with Delete data and Copy data activities." src="../../img/04-delete-data-activity.png"></a></p>
</li>
<li>
<p>Select the <strong>Delete data</strong> activity, and in the pane below the design canvas, set the following properties:</p>
<ul>
<li>
<p><strong>General</strong>:</p>
<ul>
<li><strong>Name</strong>: <code>Delete old files</code></li>
</ul>
</li>
<li>
<p><strong>Source</strong>:</p>
<ul>
<li><strong>Connection</strong>: <em>Your lakehouse</em></li>
<li><strong>File path type</strong>: Wildcard file path</li>
<li><strong>Folder path</strong>: Files / <strong>new_data</strong></li>
<li><strong>Wildcard file name</strong>: <code>*.csv</code></li>
<li><strong>Recursively</strong>: Selected</li>
</ul>
</li>
<li>
<p><strong>Logging settings</strong>:</p>
<ul>
<li><strong>Enable logging</strong>: <em><u>Un</u>selected</em></li>
</ul>
</li>
</ul>
<p>These settings will ensure that any existing .csv files are deleted before copying the <strong>sales.csv</strong> file.</p>
</li>
<li>
<p>In the pipeline designer, on the <strong>Activities</strong> tab, select <strong>Notebook</strong> to add a <strong>Notebook</strong> activity to the pipeline.</p>
</li>
<li>
<p>Select the <strong>Copy data</strong> activity and then connect its <strong>On Completion</strong> output to the <strong>Notebook</strong> activity as shown here:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/04-pipeline.png" data-desc-position="bottom"><img alt="Screenshot of a pipeline with Copy Data and Notebook activities." src="../../img/04-pipeline.png"></a></p>
</li>
<li>
<p>Select the <strong>Notebook</strong> activity, and then in the pane below the design canvas, set the following properties:</p>
<ul>
<li>
<p><strong>General</strong>:</p>
<ul>
<li><strong>Name</strong>: <code>Load Sales notebook</code></li>
</ul>
</li>
<li>
<p><strong>Settings</strong>:</p>
<ul>
<li><strong>Notebook</strong>: Load Sales</li>
<li><strong>Base parameters</strong>: <em>Add a new parameter with the following properties:</em></li>
</ul>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>table_name</td>
<td>String</td>
<td>new_sales</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>The <strong>table_name</strong> parameter will be passed to the notebook and override the default value assigned to the <strong>table_name</strong> variable in the parameters cell.</p>
</li>
<li>
<p>On the <strong>Home</strong> tab, use the <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 9H5V5h10m-3 14a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3m5-16H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V7z"></path></svg></span> (<em>Save</em>) icon to save the pipeline. Then use the <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 5.14v14l11-7z"></path></svg></span> <strong>Run</strong> button to run the pipeline, and wait for all of the activities to complete.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/04-pipeline-run.png" data-desc-position="bottom"><img alt="Screenshot of a pipeline with a Dataflow activity." src="../../img/04-pipeline-run.png"></a></p>
<div class="admonition warning">
<p class="admonition-title">If you see an error message</p>
<ul>
<li>In case you receive the error message:<ul>
<li><em>Spark SQL queries are only possible in the context of a lakehouse. Please attach a lakehouse to proceed:</em></li>
</ul>
</li>
<li>Open your notebook, select the lakehouse you created on the left pane,</li>
<li>select <strong>Remove all Lakehouses</strong> and then add it again.</li>
<li>Go back to the pipeline designer and select <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 5.14v14l11-7z"></path></svg></span> <strong>Run</strong>.</li>
</ul>
</div>
</li>
<li>
<p>In the hub menu bar on the left edge of the portal, select your lakehouse.</p>
</li>
<li>
<p>In the <strong>Explorer</strong> pane, expand <strong>Tables</strong> and select the <strong>new_sales</strong> table to see a preview of the data it contains. This table was created by the notebook when it was run by the pipeline.</p>
</li>
</ol>
<p>In this exercise, you implemented a data ingestion solution that uses a pipeline to copy data to your lakehouse from an external source, and then uses a Spark notebook to transform the data and load it into a table.</p>
<hr>
<h2 id="dont-delete-the-workspace">Don't delete the workspace</h2>
<div class="admonition danger">
<p class="admonition-title">Do not delete the workspace as you will need it in the next acticity.</p>
</div>
<hr>
<p><small><b>Source:
<a href="https://microsoftlearning.github.io/mslearn-fabric/Instructions/Labs/04-ingest-pipeline.html">https://microsoftlearning.github.io/mslearn-fabric/Instructions/Labs/04-ingest-pipeline.html</a>
</b></small></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["toc.integrate", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>